[[extend 'layout.html']] [[block page_head]]
<link
  href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
  rel="stylesheet"
/>
[[end]]

<div id="app" class="max-w-4xl mx-auto p-4 text-black">
  <h1 class="text-3xl font-bold mb-4 text-white">Ingredient Manager</h1>

  <!-- Search Input -->
  <!-- doesnt work for letters -->
  <div class="mb-8">
    <input
      v-model="searchTerm"
      @input="searchIngredients"
      class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:border-rose-400 focus:ring-rose-400 focus:outline-none"
      placeholder="🔍 Search ingredients..."
    />
  </div>

  <!-- Add Ingredient Form -->
  <div class="bg-gray-400 p-4 rounded-lg mb-6">
    <h2 class="text-xl font-semibold mb-2">Add New Ingredient</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <input
        v-model="new_ingredient.name"
        class="border rounded px-2 py-1"
        placeholder="Name"
      />
      <select
        v-model="new_ingredient.unit"
        class="border rounded px-2 py-1 w-full"
      >
        <option value="">Select a unit</option>
        <option value="grams">Grams (g)</option>
        <option value="ounces">Ounces (oz)</option>
        <option value="pounds">Pounds (lb)</option>
        <option value="kilograms">Kilograms (kg)</option>
        <option value="milliliters">Milliliters (ml)</option>
        <option value="liters">Liters (L)</option>
        <option value="cups">Cups</option>
        <option value="tablespoons">Tablespoons (tbsp)</option>
        <option value="teaspoons">Teaspoons (tsp)</option>
        <option value="pieces">Pieces (pcs)</option>
      </select>
      <!-- The v-model.number is defaulting to 0 -->
      <input
        v-model.number="new_ingredient.calories_per_unit"
        class="border rounded px-2 py-1"
        placeholder="Calories per unit"
      />
      <input
        v-model="new_ingredient.description"
        class="border rounded px-2 py-1"
        placeholder="Description (optional)"
      />
    </div>
    <button
      @click="addIngredient"
      class="mt-3 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"
    >
      Add Ingredient
    </button>
    <div v-if="error" class="text-red-500 mt-2">{{ error }}</div>
    <div v-if="success" class="text-green-500 mt-2">{{ success }}</div>
  </div>

  <!-- Ingredient List -->
  <div>
    <h2 class="text-xl font-semibold mb-2 text-white">Ingredient List</h2>
    <div v-if="ingredients.length === 0" class="text-slate-400 italic">
      No ingredients found
    </div>
    <ul v-else class="space-y-2">
      <li
        v-for="ingredient in ingredients"
        :key="ingredient.id"
        class="p-4 border border-slate-600 bg-slate-700 rounded hover:bg-slate-600 transition-colors duration-200"
      >
        <div class="flex justify-between items-start">
          <div>
            <strong class="text-white">{{ ingredient.name }}</strong>
            <span class="text-white mx-2">—</span>
            <span class="text-gray-400">{{ ingredient.unit }}</span>
            <span class="text-white mx-2">—</span>
            <span class="text-green-400"
              >{{ ingredient.calories_per_unit }} cal/unit</span
            >
          </div>
        </div>
        <div v-if="ingredient.description" class="text-sm text-gray-200 mt-1">
          {{ ingredient.description }}
        </div>
      </li>
    </ul>
  </div>
</div>

[[block page_scripts]]
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<script src="/Cravely/static/js/ingredient_list.js"></script>
[[end]]
